<?php
/**
 * @package     Joomla.Administrator
 * @subpackage  com_akquickicons
 *
 * @copyright   Copyright (C) 2012 Asikart. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 * @author      Generated by AKHelper - http://asikart.com
 */

// no direct access
defined('_JEXEC') or die;

JHtml::_('behavior.tooltip');
JHtml::_('behavior.formvalidation');
JHtml::_('behavior.keepalive');

if( JVERSION >= 3){
	JHtml::_('formbehavior.chosen', 'select');
}



// Init some API objects
// ================================================================================
$app 	= JFactory::getApplication() ;
$date 	= JFactory::getDate( 'now' , JFactory::getConfig()->get('offset') ) ;
$doc 	= JFactory::getDocument();
$uri 	= JFactory::getURI() ;
$user	= JFactory::getUser();


// Edit setting
// ================================================================================
$tabs = count( $this->fields ) > 1 ? true : false;

$span_left 	= 8 ;
$span_right = 4 ;

$width_left = 60 ;
$width_right= 40 ;

if(JVERSION >= 3) {
	// Quicnicons
	$doc->addStylesheet( 'components/com_akquickicons/includes/akicons/css/akicons.css') ;
}

?>
<script type="text/javascript">
	Joomla.submitbutton = function(task)
	{
		if (task == 'icon.cancel' || document.formvalidator.isValid(document.id('icon-form'))) {
			Joomla.submitform(task, document.getElementById('icon-form'));
		}
		else {
			alert('<?php echo $this->escape(JText::_('JGLOBAL_VALIDATION_FORM_FAILED'));?>');
		}
	}
</script>

<form action="<?php echo JRoute::_( JFactory::getURI()->toString() ); ?>" method="post" name="adminForm" id="icon-form" class="form-validate">
	
	
	<?php if( JVERSION >= 3 ): ?>
	<!-- Tab Buttons -->
	<ul class="nav nav-tabs">
		<?php foreach( $this->fields as $key => $group): ?>
		<li class="<?php echo $key == 0 ? 'active' : ''; ?>">
			<a href="#<?php echo $group; ?>" data-toggle="tab"><?php echo JText::_('COM_AKQUICKICONS_EDIT_FIELDS_'.$group); ?></a>
		</li>
		<?php endforeach; ?>
	</ul>
	<?php endif; ?>
	
	
	<!-- Tab Bodys -->
	<?php echo $tabs ? AkquickiconsHelper::_('panel.startTabs', 'iconTab', array( 'active' => $this->fields[0] ) ) : null ; ?>
		<?php foreach( $this->fields as $key => $group ): 
				$fieldsets = $this->form->getFieldsets($group) ;
				
				echo $tabs ? AkquickiconsHelper::_('panel.addPanel' , 'iconTab', JText::_('COM_AKQUICKICONS_EDIT_FIELDS_'.$group) , $group ) : null ;
		?>
			<div class="row-fluid">
			
				
				<!-- Left Bar -->
				<div class="span<?php echo $span_left; ?><?php echo JVERSION < 3 ? ' width-'.$width_left : '' ;?> fltlft">
					
					<?php foreach( $fieldsets as  $k => $fieldset ): ?>
						
						<?php if( empty($fieldset->align) ) $fieldset->align = 'left' ; ?>
						<?php if( $fieldset->align == 'right' ) continue; ?>
						
						<?php
						if(!empty($fieldset->horz) && $fieldset->horz !== 'false'){
							$form_class = 'form-horizontal' ;
						}else{
							$form_class = '' ;
						}
						?>
						
						<fieldset class="adminform <?php echo $form_class; ?>">
						<legend><?php echo JText::_('COM_AKQUICKICONS_EDIT_FIELDSET_'.$fieldset->name); ?></legend>
						
						<?php foreach($this->form->getFieldset($fieldset->name) as $field ): ?>
							<?php if( JVERSION < 3 && $field->type == 'Icon_Modal' ) continue; ?>
							<div class="control-group">
								<?php echo $field->label ;?>
								<div class="controls">
									<?php echo $field->input; ?>
								</div>
							</div>
						<?php endforeach; ?>
						
						<br /><br />
						
						</fieldset>
						
					<?php endforeach; ?>
					
				</div>
				
				
				<!-- Right Bar -->
				<div class="span<?php echo $span_right; ?><?php echo JVERSION < 3 ? ' width-'.$width_right : '' ;?> fltlft">
					
					<?php foreach( $fieldsets as  $k => $fieldset ): ?>
						
						<?php if( empty($fieldset->align) ) $fieldset->align = 'left' ; ?>
						<?php if( $fieldset->align == 'left' ) continue; ?>
						
						<?php
						if(!empty($fieldset->horz) && $fieldset->horz !== 'false'){
							$form_class = 'form-horizontal' ;
						}else{
							$form_class = '' ;
						}
						?>
						
						<fieldset class="adminform <?php echo $form_class; ?>">
						<legend><?php echo JText::_('COM_AKQUICKICONS_EDIT_FIELDSET_'.$fieldset->name); ?></legend>
						
						<?php foreach($this->form->getFieldset($fieldset->name) as $field ): ?>
							<div class="control-group">
								<?php echo $field->label; ?>
								<div class="controls">
									<?php echo $field->input; ?>
								</div>
							</div>
						<?php endforeach; ?>
						
						<br /><br />
						
						</fieldset>
						
					<?php endforeach; ?>
					
				</div>
			
			</div>
			
			<div class="clr"></div>
			
			<?php echo $tabs ? AkquickiconsHelper::_('panel.endPanel' , 'iconTab' , $group ) : null ; ?>
			
		<?php endforeach; ?>
		
		<?php echo $tabs ? AkquickiconsHelper::_('panel.endTabs' ) : null ; ?>
	
	
	<!-- Hidden Inputs -->
	<div id="hidden-inputs">
		<input type="hidden" name="option" value="com_akquickicons" />
		<input type="hidden" name="task" value="" />
		<?php echo JHtml::_('form.token'); ?>
	</div>
	<div class="clr"></div>
</form>